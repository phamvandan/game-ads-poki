"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[388],{6014:(e,t,n)=>{n.r(t),n.d(t,{fetchSaveGameEpic:()=>z,fixIOSFullscreen:()=>X,forwardPostMessageEpic:()=>$,fullscreenEpic:()=>ie,gameBootEpic:()=>Z,gameLoadingFinishedEpic:()=>re,generateScreenshotEpic:()=>oe,mutateSaveGameEpic:()=>q,pubHostInitializedEpic:()=>j,receivePostMessageEpic:()=>P,receiveScreenshotEpic:()=>le,setRecentGameEpic:()=>te,switchWorldToEpic:()=>W,trackRecentGameEpic:()=>ne,updatePokiURLParams:()=>K,worldSwitchedToEpic:()=>C});var i=n(1545),r=n(2817),o=n(2401),a=n(3071),l=n(6625),c=n(9635),u=n(4975),p=n(2006),s=n(9127),d=n(533),v=n(4978),m=n(6108),g=n(7782),w=n(2965),f=n(3505),h=n(4406),y=n(7606),E=n(5069),_=n(4678),b=n(8813),T=n(905),S=n(3748),k=n(4481),U=n(6151),B=n(7344),I=n(8855),O=n(8656),D=n(9563),R=n(65),A=n(8092),F=n(4927),L=n(8342),G=n(6084),V=n(5585),H=n(4691),M=n(9317),N=n(6619);const x=["localhost","games.poki.com","game-cdn.poki.com"],J={CrossyMultiverseMessage_worldSwitchedTo:T.VN,pubHostInitialized:T.B5,[D.cO]:T.OB,[D.xE]:T.aw,[D.A$]:T.PP,[D.Yn]:T.iq,[D.Fj]:T.BF,fetchSaveGame:T.WV,mutateSaveGame:T.nE,SaveGameMigrator:!0};function P(e){return e.pipe((0,E.l)(T.y6.type),(0,u.h)((e=>{let{event:t}=e;if(!t.data.type||!J[t.data.type])return!1;const n=(0,k._Y)(t.origin),i=x.includes(n)||n.endsWith(".poki-gdn.com")||window.location.origin===t.origin,r=document.querySelector('iframe[name="gameFrame"]'),o=r&&r.src.startsWith(t.origin);return i||o})),(0,p.b)((e=>{let{event:{data:{content:t,type:n}}}=e;if(["pokiMessageEvent","pokiMessageDebug","SaveGameMigrator"].includes(n)&&((0,S.A)({category:"sdk",action:"message",data:{content:t,type:n}}),window.parent!==window)){const e="production"===process.env.SERVICE_ENV;window.parent.postMessage({content:t,type:n},e?"devs.poki.io":"*")}})),(0,u.h)((e=>{let{event:{data:{type:t}}}=e;return"function"==typeof J[t]})),(0,s.U)((e=>{let{event:{data:{content:t,type:n},source:i}}=e;return J[n]({...t,source:i})})))}function W(e,t){return e.pipe((0,E.l)(T.Ot.type),(0,u.h)((()=>window.frames.gameFrame)),(0,u.h)((e=>{let{world:n}=e;return(0,I.Bs)(t.value)!==n})),(0,p.b)((e=>{var t,n,i;let{world:r}=e;null===(t=window)||void 0===t||null===(n=t.frames)||void 0===n||null===(i=n.gameFrame)||void 0===i||i.postMessage({type:"CrossyMultiverseMessage_switchWorldTo",content:{worldName:r}},"*")})),(0,s.U)((e=>(0,T.Bn)({world:e,gameId:(0,O.J1)(t.value).id}))))}function C(e,t){return e.pipe((0,E.l)(T.VN.type),(0,s.U)((e=>{let{worldName:t}=e;return t})),(0,u.h)((e=>(0,I.Bs)(t.value)!==e)),(0,s.U)((e=>(0,T.Bn)({world:e,gameId:(0,O.J1)(t.value).id}))))}function K(e){return e.pipe((0,E.l)(T.PP.type),(0,p.b)((e=>{const{params:t}=e;if(!t)return;const n=Object.keys(t),i=new URLSearchParams(window.location.search),r=[];i.forEach(((e,t)=>{t.startsWith("gd")&&r.push(t)})),r.forEach((e=>{i.delete(e)})),n.forEach((e=>{i.set("gd".concat(e),t[e])})),window.history.replaceState({},document.title,"".concat(window.location.pathname,"?").concat(i.toString()))})),(0,d.l)())}function Z(e){return e.pipe((0,E.l)(T.Gq.type),(0,p.b)((()=>{(0,S.A)({category:"game",action:"iframeLoaded",options:{once_per_pageview:!0}}),(0,R.u)()})),(0,d.l)())}function j(e,t){return e.pipe((0,E.l)(T.B5.type),(0,v.w)((e=>{const n=(0,O.J1)(t.value);return n?((0,S.A)({category:"pubHost",action:"initialized",data:e}),(0,r.of)((0,T.P8)({gameId:n.id,data:e}))):i.E})))}function q(e,t){return e.pipe((0,E.l)(T.nE.type),(0,p.b)((async e=>{let{action:n,key:i,value:r}=e;const o=(0,O.J1)(t.value);if(o)try{const e=(0,_.MT)("savegame:".concat(o.id),"ls");"clear"===n?await(0,_.ZH)(e):"delete"===n?await(0,_.IV)(i,e):"set"===n&&await(0,_.t8)(i,r,e)}catch(e){console.error(e)}})),(0,d.l)())}function z(e,t){return e.pipe((0,E.l)(T.WV.type),(0,p.b)((async()=>{const e=(0,O.J1)(t.value);if(e)try{var n,i,r;const t=(0,_.MT)("savegame:".concat(e.id),"ls"),o=(await(0,_.qh)(t)).reduce(((e,t)=>{let[n,i]=t;return e[n]=i,e}),{});null===(n=window.frames)||void 0===n||null===(i=n.gameFrame)||void 0===i||null===(r=i.postMessage)||void 0===r||r.call(i,{type:"fetchedSaveGame",data:o},"*")}catch(e){console.error(e)}})),(0,d.l)())}function $(){return window.removeEventListener("message",messageListener),(0,o.R)(window,"message").pipe((0,m.O)(...messageBuffer),(0,g.g)(0),(0,s.U)((e=>(0,T.y6)({event:e}))))}const Y=()=>document.getElementById("game-container"),Q=()=>{const e=document.getElementById("game-element");e&&(window.scrollTo(0,0),e.style.width="".concat(window.innerWidth,"px"),e.style.height="".concat(window.innerHeight,"px"))};function X(e,t){if(!(0,U.eD)(t.value)||"undefined"==typeof window)return i.E;const n=(0,o.R)(window,"resize").pipe((0,g.g)(500),(0,v.w)((()=>(Q(),i.E))),(0,w.b)(3e3)),r=(0,o.R)(window,"orientationchange").pipe((0,v.w)((()=>(Q(),i.E))),(0,w.b)(3e3));return e.pipe((0,E.l)(T.Gq.type),(0,g.g)(3e3),(0,p.b)((()=>{(0,R.u)(),Q()}))).pipe((0,v.w)((()=>(0,a.T)(n,r))))}const ee=async(e,t)=>{const n=(0,U.At)(t),i=(0,U.QJ)(t);if(!n&&!i){try{var r;await(null==e||null===(r=e.requestFullscreen)||void 0===r?void 0:r.call(e,{navigationUI:"hide"}).catch((()=>{})))}catch(e){}e.focus()}const o=(0,O.J1)(t);if((0,U.eD)(t)&&o&&o.mobile_file&&o.mobile_file.orientation){const{orientation:e}=o.mobile_file;if(["portrait","landscape"].includes(e))try{var a,l,c,u;null===(a=window)||void 0===a||null===(l=a.screen)||void 0===l||null===(c=l.orientation)||void 0===c||null===(u=c.lock)||void 0===u||u.call(c,e).catch((()=>{}))}catch(e){}}};function te(e,t){if("undefined"==typeof window)return i.E;const n=(0,B.lH)(t.value);return e.pipe((0,E.l)(b.JV.type,F.o8.type),(0,u.h)((()=>{const e="game"===(0,O.Wj)(t.value),n=(0,O.Q4)(t.value);return e&&200===n})),(0,s.U)((()=>{const e=(0,O.J1)(t.value),{id:r}=e||{};if(!r)return i.E;const o=(0,U.jw)(t.value)||[],a=o.findIndex((e=>e.id===r)),l=a>-1?o.filter((e=>e.id!==r)):o,c={id:r,pt:a>-1?o[a].pt:0};l.unshift(c);const u=l.slice(0,12);return(0,b.FR)({recentGames:u,siteID:n.id})})))}function ne(e,t){if("undefined"==typeof window)return i.E;const n=(0,B.lH)(t.value),r=e.pipe((0,E.l)(F.o8.type));return e.pipe((0,E.l)(b.FR.type),(0,v.w)((()=>(0,l.H)(6e4).pipe((0,s.U)((()=>{const{id:e}=(0,O.J1)(t.value),r=(0,U.jw)(t.value),o=r.find((t=>t.id===e));if(o){const t=parseInt(o.pt||0,10)+1,i=r.map((n=>n.id===e?{...n,pt:t}:n));return(0,b.FR)({recentGames:i,siteID:n.id})}return i.E})),(0,f.R)(r)))))}function ie(e,t){const n=(0,o.R)(window,"fullscreenchange").pipe((0,v.w)((()=>{var e,n,o;return(0,N.k)(),(0,I.Eo)(t.value)!==!(null===(e=document)||void 0===e||!e.fullscreenElement)&&(!(0,U.eD)(t.value)||null!==(n=document)&&void 0!==n&&n.fullscreenElement)?(0,r.of)((0,T.K1)({toggle:!(null===(o=document)||void 0===o||!o.fullscreenElement)})):i.E}))),l=e.pipe((0,E.l)(T.Zx.type),(0,u.h)((e=>{let{toggle:t}=e;return t})),(0,v.w)((()=>(0,c.D)(ee(document.body,t.value)).pipe((0,s.U)((()=>(0,T.K1)({toggle:!0}))))))),m=()=>{var e,t,n;null===(e=window)||void 0===e||null===(t=e.PokiSDK)||void 0===t||null===(n=t.stopVideoAd)||void 0===n||n.call(t),(0,A.aH)();try{var i,o;null===(i=document)||void 0===i||null===(o=i.exitFullscreen)||void 0===o||o.call(i).catch((()=>{}))}catch(e){}return window.removeEventListener("resize",Q),window.removeEventListener("orientationchange",Q),(0,r.of)((0,T.K1)({toggle:!1}))},g=e.pipe((0,E.l)(T.Zx.type),(0,u.h)((e=>{let{toggle:t}=e;return!t})),(0,v.w)((()=>m()))),w=e.pipe((0,E.l)("@@router/LOCATION_CHANGE"),(0,u.h)((()=>!window.location.toString().includes("#fullscreen")&&!window.location.toString().includes("#goog_rewarded"))),(0,v.w)((()=>m()))),h=e.pipe((0,E.l)(T.Gq.type),(0,u.h)((e=>{let{el:n}=e;return(0,U.eD)(t.value)&&n})),(0,v.w)((e=>{let{el:n}=e;return(0,a.T)((0,o.R)(Y(),"click"),(0,o.R)(n,"click")).pipe((0,u.h)((()=>(0,U.eD)(t.value))),(0,p.b)((()=>{ee(document.body,t.value)})),(0,f.R)(g),(0,d.l)())}))),y=e.pipe((0,E.l)(T.K1.type),(0,v.w)((e=>{let{toggle:t}=e;const{body:n}=document,r=document.getElementById("app-root");return r.style.overflow=t?"hidden":"auto",r.style.height=t?"100vh":"auto",t?n.classList.add("isFullscreen"):n.classList.remove("isFullscreen"),i.E})));return(0,a.T)(l,g,w,n,h,y)}function re(e){return e.pipe((0,E.l)(T.OB.type),(0,u.h)((e=>{let{event:t}=e;return t===D.tn})),(0,s.U)((()=>(0,T.sn)())))}function oe(e,t){return e.pipe((0,E.l)(T.mY.type),(0,h.p)(3e3),(0,u.h)((()=>{var e,t;return null===(e=window)||void 0===e||null===(t=e.frames)||void 0===t?void 0:t.gameFrame})),(0,p.b)((e=>{var n;let{callback:i}=e;const r="screenshot"===i,o=(0,O.J1)(t.value);window.frames.gameFrame.postMessage({type:"pokiGenerateScreenshot",hasFrame:r,title:o.title,thumbnail:null===(n=o.image)||void 0===n?void 0:n.path,callback:i},"*")})))}const ae=(e,t)=>{var n;const i=(0,H.fx)(t.value),r="".concat(i,"\n\n").concat(e),o=(0,L.Z)(t.value,"tracking"),a=(0,G.d)(t.value),l=(0,I.R6)(t.value),c=(0,B.lH)(t.value),u=(0,O.J1)(t.value),p=(0,M.N9)(t.value),s=(0,I.FK)(t.value),v=(0,I.tL)(t.value),m=(0,V.W)(t.value),g=l.gameID===u.pokifordevs_game_id?l.gameVersion:void 0,w=(null==m||null===(n=m.page)||void 0===n?void 0:n.start)>0?Date.now()-m.page.start:0,f=document.getElementById("game-element");let h;f&&(h="".concat(f.clientWidth,"x").concat(f.clientHeight));return o("/playground-feedback",{method:"POST",body:JSON.stringify({p4d_game_id:u.pokifordevs_game_id,p4d_version_id:g,type:"bugreport",site_id:c.id,message:r,experiment:a,adblock:p,was_fullscreen:s,game_resolution:h,loading_finished:v,time_on_page:w})}).pipe((0,d.l)())};function le(e,t){return e.pipe((0,E.l)(T.BF.type),(0,y.j)("data"),(0,v.w)((e=>{let{screenshot:n,callback:r}=e;if(!r||"bugReport"===r)try{return ae(n,t)}catch(e){return i.E}})))}},8565:(e,t,n)=>{n.r(t),n.d(t,{getPageDoneEpic:()=>p});var i=n(5069),r=n(2006),o=n(533),a=n(4927),l=n(6619),c=n(6343),u=n(8656);function p(e,t){return e.pipe((0,i.l)(a.o8.type),(0,r.b)((()=>{(0,l.k)(),(0,c.Z)((0,u.$g)(t.value))})),(0,o.l)())}},7529:(e,t,n)=>{n.r(t),n.d(t,{checkForSmartRefreshEpic:()=>V,enableDumbRefreshEpic:()=>G,enableRefreshEpic:()=>F,hideAdsStatusEpic:()=>W,refreshAdsEpic:()=>L,setAdStatusEpic:()=>x,setAdTimingsEpic:()=>J,showAdsStatusEpic:()=>P,smartRefreshEpic:()=>H,startImmersiveTakeoverEpic:()=>M,stopImmersiveTakeoverEpic:()=>N});var i=n(5069),r=n(2817),o=n(6697),a=n(3071),l=n(1545),c=n(4975),u=n(9127),p=n(7877),s=n(4978),d=n(3505),v=n(2006),m=n(533),g=n(7782),w=n(4727),f=n(7753),h=n(4862),y=n(905),E=n(4927),_=n(8813),b=n(9317),T=n(1308),S=n(8656),k=n(3748),U=n(8855),B=n(9563),I=n(65);const O=6e4,D=3e4,R=5e3;let A=Date.now();function F(e,t){return e.pipe((0,i.l)(_.Qi.type,E.o8.type),(0,c.h)((()=>["game","preview"].includes((0,S.Wj)(t.value)))),(0,u.U)((()=>(0,h.oI)())))}function L(e,t){return e.pipe((0,i.l)(h._g.type),(0,c.h)((()=>!(0,U.Eo)(t.value))),(0,p.z)((e=>{let{refreshType:n}=e;const i=(0,T.O)(t.value).map((e=>{let{code:t}=e;return(0,h.SB)({code:t,refreshType:n})}));return(0,r.of)(...i)})))}function G(e){const t=e.pipe((0,i.l)(h.xL.type,"@@router/LOCATION_CHANGE"));return e.pipe((0,i.l)(h.oI.type),(0,s.w)((()=>(0,o.F)(O).pipe((0,u.U)((()=>(0,h._g)({trigger:"dumb",refreshType:"dumb"}))),(0,d.R)(t)))))}function V(e,t){return e.pipe((0,i.l)(y.aw.type),(0,v.b)((e=>{(0,k.A)({category:"sdk",action:"details",data:e})})),(0,u.U)((e=>{let{version:t}=e;return t})),(0,c.h)((e=>Number(e[0])>=2)),(0,c.h)((()=>{const e=(0,S.J1)(t.value);return e&&e.allow_smart_refresh})),(0,u.U)((()=>(0,h.xL)())))}function H(e){const t=e.pipe((0,i.l)("@@router/LOCATION_CHANGE")),n=[B.$4,B.Fd,B.rV],r=e.pipe((0,i.l)(y.OB.type),(0,u.U)((e=>{let{event:t}=e;return t})),(0,c.h)((e=>n.includes(e))),(0,c.h)((()=>Date.now()-A>=D)),(0,u.U)((e=>(0,h._g)({trigger:e,refreshType:"smart"}))),(0,v.b)((()=>{A=Date.now()})),(0,d.R)(t));return(0,a.T)(e.pipe((0,i.l)(h.xL.type),(0,v.b)((()=>{A=Date.now()})),(0,s.w)((()=>r))),e.pipe((0,i.l)(h.V6.type),(0,v.b)((()=>{A=Date.now()})),(0,m.l)()))}function M(e,t){return e.pipe((0,i.l)(y.OB.type),(0,c.h)((e=>{let{event:t}=e;return t===B.T4})),(0,u.U)((e=>{var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.creativeId})),(0,u.U)((e=>({creativeId:e,config:((0,S.Br)(t.value)||{})[e]}))),(0,c.h)((e=>!!e.config)),(0,u.U)((e=>(0,h.WY)({takeover:e}))))}function N(e,t){const n=e.pipe((0,i.l)(h._g.type)),r=e.pipe((0,i.l)(E.o8.type)),o=e.pipe((0,i.l)(y.OB.type),(0,c.h)((e=>{let{event:t}=e;return t===B.$K}))),l=o.pipe((0,g.g)(R),(0,w.q)(1),(0,s.w)((()=>n)),(0,d.R)(r)),p=(0,b.sY)(t.value);return(0,a.T)(r.pipe((0,c.h)((()=>!!(0,b.xU)(t.value))),(0,u.U)((()=>(0,h.V6)()))),r.pipe((0,c.h)((()=>p&&p.immersiveTakeover)),(0,u.U)((()=>(0,h.ST)()))),o.pipe((0,s.w)((()=>n.pipe((0,f.T)(1),(0,u.U)((()=>(0,h.V6)())))))),l.pipe((0,u.U)((()=>(0,h.ST)()))))}function x(e){return e.pipe((0,i.l)(y.OB.type),(0,c.h)((e=>{let{event:t}=e;return[B.Zg,B.T4,B.$K].includes(t)})),(0,u.U)((e=>{let{event:t}=e;return(0,y.Iy)({event:t})})))}function J(e){return e.pipe((0,i.l)(y.OB.type),(0,c.h)((e=>{let{event:t}=e;return[B.T4,B.cV].includes(t)})),(0,p.z)((e=>{const{data:t,event:n}=e;switch(n){case B.T4:return(0,r.of)((0,y.BZ)({duration:t.duration,currentTime:0}));case B.cV:return(0,r.of)((0,y.BZ)({duration:t.duration,currentTime:t.currentTime}));default:return l.E}})))}function P(e){return e.pipe((0,i.l)(y.OB.type),(0,c.h)((e=>{let{event:t}=e;return[B.Fd,B.rV].includes(t)})),(0,u.U)((()=>(0,y.rg)())))}function W(e){return e.pipe((0,i.l)(y.OB.type,E.o8.type),(0,c.h)((e=>{let{event:t,type:n}=e;return[B.$K,B.Uo,B.jZ].includes(t)||n===E.o8.type})),(0,v.b)((()=>{(0,I.u)()})),(0,u.U)((()=>(0,y.oK)())))}},2315:(e,t,n)=>{n.r(t),n.d(t,{updateSessionEpic:()=>l});var i=n(5069),r=n(2006),o=n(533),a=n(8941);function l(e){return e.pipe((0,i.l)(a.C.type),(0,r.b)((e=>{let{path:t,pageType:n,pageID:i}=e;window.tracker.push((()=>{window.updateSession(t,n,i)}))})),(0,o.l)())}}}]);